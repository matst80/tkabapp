window.SCS="http://tkab.wd7dev.se/Core.WebShop,Core.WebShop.ShopCommon.asmx/";_sc=function(){};_sc.ds=function(){};_sc.de=function(){};_sc.path=SCS;_sc.req=function(d,c,a,b){var e=a?a:_sc.ds,f=b?b:_sc.de;return ar(_sc.path+d,c,e,f)};_sc.GetArticles=function(a,b,c,d){_sc.req("GetArticles",{pageid:a,clientId:b},c,d)};_sc.GetArticle=function(a,b,c){_sc.req("GetArticle",{artnr:a},b,c)};_sc.GetPaymentMethods=function(a,b){_sc.req("GetPaymentMethods",{},a,b)};_sc.GetCnf=function(a,b,c){_sc.req("GetCnf",{pageid:a},b,c)};_sc.GetArticlesAdmin=function(a,b,c,d){_sc.req("GetArticlesAdmin",{pageid:a,clientId:b},c,d)};_sc.GetCustomer=function(a,b){_sc.req("GetCustomer",{},a,b)};_sc.IsValidCustomer=function(a,b){_sc.req("IsValidCustomer",{},a,b)};_sc.LoginCustomer=function(a,b,c,d){_sc.req("LoginCustomer",{username:a,password:b},c,d)};_sc.Logout=function(a,b){_sc.req("Logout",{},a,b)};_sc.newCart=function(a,b){_sc.req("newCart",{},a,b)};_sc.LookupAddress=function(a,b,c,d){_sc.req("LookupAddress",{vatnr:a,iscompany:b},c,d)};_sc.CheckUser=function(a,b,c){_sc.req("CheckUser",{username:a},b,c)};_sc.GetCurrentCustomer=function(a,b){_sc.req("GetCurrentCustomer",{},a,b)};_sc.SaveCustomer=function(a,b,c){_sc.req("SaveCustomer",{data:a},b,c)};_sc.GetUserFields=function(a,b){_sc.req("GetUserFields",{},a,b)};_sc.ResetPassword=function(a,b,c){_sc.req("ResetPassword",{user:a},b,c)};_sc.GetProperties=function(a,b,c,d){_sc.req("GetProperties",{pageid:a,clientId:b},c,d)};_sc.GetAllArticles=function(a,b,c,d,e){_sc.req("GetAllArticles",{parentId:a,searchSubpages:b,fields:c},d,e)};_sc.ChangeNoi=function(a,b,c,d){_sc.req("ChangeNoi",{id:a,noi:b},c,d)};_sc.AddToCart=function(a,b,c,d,e,f,g,h){_sc.req("AddToCart",{artnr:a,noi:b,imageFallback:c,bodyFallback:d,referrer:e,addNew:f},g,h)};_sc.RemoveFromCart=function(a,b,c){_sc.req("RemoveFromCart",{id:a},b,c)};_sc.GetCart=function(a,b){_sc.req("GetCart",{},a,b)};_sc.ClearCart=function(a,b){_sc.req("ClearCart",{},a,b)};_sc.ChangePassword=function(a,b,c,d){_sc.req("ChangePassword",{oldPassword:a,newPassword:b},c,d)};_sc.updateZone=function(a,b,c){_sc.req("UpdateZone",{name:a},b,c)};_sc.GetCart2=function(a,b,c){_sc.req("GetCart2",{oid:a},b,c)};_sc.GetPrice=function(a,b,c){_sc.req("GetPrice",{artnr:a},b,c)};_sc.ApplyCode=function(a,b,c){window._gaq&&_gaq.push(["_trackEvent","AddCampaign","click"]);_sc.req("ApplyCode",{code:a},b,c)};_sc.GetArticlesArray=function(a,b,c){_sc.req("GetArticlesArray",{artnr:a},b,c)};_sc.CalcMultiPrice=function(a,b,c){_sc.req("CalcMultiPrice",{artNrs:a},b,c)};_sc.FbLogin=function(a,b,c,d){_sc.req("LoginFacebook",{fbid:a,fbtoken:b},c,d)};_sc.AddToCartMultiple=function(a,b,c,d,e,f,g,h,i){_sc.req("AddToCartMultiple",{oid:a,arts:b,imageFallback:c,bodyFallback:d,referrer:e,addNew:f,addAsSub:g},h,i)};shopcommon=_sc;ql.dep("articleKit",wdRoot+"/dep/articlekit.js",wdRoot+"/dep/articlekit.css");ql.dep("prodfilter",wdRoot+"/dep/prodfilter.js");ql.dep("shoplogin",wdRoot+"/dep/shoplogin.js");ql.dep("quickBuy",wdRoot+"/dep/quickbuy.js");ql.dep("editPackage",wdRoot+"/dep/shop-package.js");ql.dep("editPriceLists",wdRoot+"/dep/shop-pricelist.js");ql.$pre("articleKit",1);ql.$pre("quickBuy",1);ql.$pre("editPackage",0);ql.$pre("prodfilter",1);ql.$pre("shoplogin",1);ql.$pre("editPriceLists",0);(function(a){var e=navigator.userAgent.match(/iPhone/i)?"touchstart":"click";window.GetQRData=function(){b.GetQRData()};window.shopOpt=a.extend(true,{lang:{cur:" kr",buyBtn:"Lägg i kundkorg",cartsum:"Att betala:",cartsumexvat:"Att betala (exkl moms):",noitext:"",shipping:"Frakt:",shippingexvat:"Frakt (ex moms):",hasstocktxt:"Varan finns i lager",nostocktxt:"Finns inte i lager",adminfee:"Administrativ avgift",loggedinlink:"Logga in för att hämta sparad kundinformation",discount:"Rabatt:",discountexvat:"Rabatt (ex moms):",totalsum:"Summa ink moms:",totalsumexvat:"Summa ex moms:",close:"Stäng",gotocart:"Gå till kassan",noiincart:"Du har {0}st i kundkorgen",noiincartbtn:"st i kundkorg",stockcart:"Tyvärr är har vi inga fler artiklar i lager",addincart:"Klicka för att lägga i kundkorgen",stockcart2:"Tyvärr finns inte ditt val kvar i lager, prova ett annat alternativ",cartcheck:"Kontrollera dina val och försök igen",loggedintxt:"Ändra dina uppgifter ({0})",notavailable:"Inte tillgänglig",notavailabletxt:"Inte tillgänglig",stockstatus:"Lagerstatus",pricestock:"Ej i lager",notinzone:"Ej tillgänglig",notinzonetxt:"Ej tillgänglig i ditt land",emptycart:"Töm kundkorgen",notinstock:"Inte i lager",cartintro:"<h3>Lagt i kundkorgen</h3><p>Dessa artiklar har precis blivit lagda i kundkorgen</p>",incarttxt:"<h3>Artiklar i kundkorgen</h3><p>Här är de artiklar du lagt i kundkorgen</p>",remove:"Ta bort",ofwhichvat:"Varav moms:",vat:"Moms:",addshopcode:"Lägg till",btnloading:"Köper...",addingtocart:"Produken läggs redan i kundkorgen, vänligen vänta",fields:{size:"Välj storlek",supplier:"Välj varumärke",color:"Välj färg",parent:"Kategori"}},useArticleCache:true,notInStockOpacity:"0.5",checkStock:true,showNoiOnButton:true,cartDefault:{imgw:80,imgh:90,overview:true,noi:4,newitemdelay:4e3,openevent:e,checkoutUrl:"/checkout",itemsInCartText:"Du har {0}st varor i kundkorgen<br/>Summa: {1}kr",cartEmptyText:"Du har inga varor i kundkorgen"},hideNotInStock:false,showButtonDirect:true,autoSelect:false,autoSelectFirst:false,useSlider:false,showFirst:false,languages:["Sverige","Norge","Finland","Danmark","Tyskland","Estland"]},window.shopOpt||{});a.mergeShopOpt=function(b){a.extend(true,window.shopOpt,b)};var b=window.wdShop={opt:{affect:".wd-shop-affect"},fetchAsyncPrices:function(c){var d={},b=false;c&&a(window).trigger("updateprices");a("span."+(c?"oldsfnr":"sfnr")).each(function(){var c=a(this).data("fnr")+"";if(c&&c.length){d[a(this).attr("id")]=c;b=true}});b&&_sc.req("GetAsyncPrices",{fetch:d},function(b){a.each(b,function(b,c){a("#"+b).removeClass("sfnr").addClass("oldsfnr").html(c).show()})})},logout:function(b){shopcommon.Logout(function(){a.cookie("exvat","",{expires:-1,path:"/"});a.cookie("customerId","",{expires:-1,path:"/"});a(window).trigger("shoplogout");shopOpt.onlogout&&shopOpt.onlogout();if(b)window.location.href=b;else window.location.reload()})},GetQRData:function(){window._gaq&&_gaq.push(["_trackEvent","OpenPayAir","click"]);ar("/Core.WebShop,Core.WebShop.PaymentProviders.Helpers.PayAirAdmin.asmx/GetQR",{},function(a){if(window.Payair_DATA){Payair_DATA.setCheckoutPrice(a.price);Payair_DATA.setCheckoutCurrency(a.c);Payair_DATA.setQR_data(a.qr)}})},alphaSort:function(a,b){return a.localeCompare(b)},sizeSort:function(a,b){var d=function(a){return!isNaN(parseFloat(a))&&isFinite(a)};if(d(a)&&d(b))return a-b;else{var e={s:-1,m:0,l:1},c=function(a){a=a.toLowerCase();var c=1,b=1;for(i=0;i<a.length;i++){var d=a[i];if(d=="x")c++;else b=e[d]}return c*b};return c(a)-c(b)}},showExVat:function(d){if(!d||b.fVat==undefined||b.fVat==""){var c=a.cookie("exvat");return c&&c=="1"}else return b.fVat=="ex"},handlers:{hidden:function(){this.createOptions=function(){};this.getValue=function(){return this.val};this.setValue=function(a){this.val=a};this.beforeUpdate=function(){};this.afterUpdate=function(){};this.updateAlt=function(){};this.create=function(){}},select:function(){this.createOptions=function(){var b=this.obj;a.each(this.availOptions,function(d,c){b.append(a("<option/>",{value:c,text:c}))})},this.getValue=function(){return this.obj.val()},this.setValue=function(a){this.obj.val(a)},this.beforeUpdate=function(){this.obj.find("option").addClass("hidden")},this.afterUpdate=function(){},this.updateAlt=function(b){var c=this.obj;a.each(b,function(b,a){c.find('option[value="'+a+'"]').removeClass("hidden")})},this.create=function(d,e,c){this.doupdate=c;var b=this.obj=a("<select>").change(this.doupdate).appendTo(e);b.append(a('<option value="">-- '+d.n+" --</option>"));return b}},image:function(){this.createOptions=function(){var c=this.cnt,b=this;if(this.availOptions.length==1){c.parent().hide();return}a.each(this.availOptions,function(h,d){var f=d.toLowerCase().replace(/å/igm,"a").replace(/ö/igm,"o").replace(/ä/igm,"a").replace(/[^0-9A-Za-z\/\-\._]+/igm,""),g=a("<img/>",{src:"/Userfiles/Shop/"+b.fieldId+"/"+f+".jpg","class":"imgsel",title:d}).attr("rel",d).data("opt",d).bind(e,function(){if(a(this).hasClass("active")){b.curr=null;a(this).removeClass("active")}else{c.find(".imgsel").removeClass("active");b.curr=a(this).addClass("active").data("opt")}b.doupd(true)}).appendTo(c);window.wdGlobal&&g.dragdropfile({dir:"/Userfiles/Shop/"+b.fieldId+"/",filename:f+".jpg",onload:function(c,b,a){b.attr("src",a.dir+a.filename+"?new="+Math.random()*100)}})});c.contentslider({noi:5,size:500,horizontal:true})};this.getValue=function(){return this.curr};this.setValue=function(a){this.cnt.find(".imgsel").removeClass("active");this.cnt.find('.imgsel[rel="'+a+'"]').addClass("active");this.curr=a};this.beforeUpdate=function(){this.cnt.find(".imgsel").addClass("hidden")};this.afterUpdate=function(){};this.updateAlt=function(b){var c=this.cnt;a.each(b,function(d,b){c.find(".imgsel").each(function(){var c=a(this),d=c.data("opt");d==b&&c.removeClass("hidden")})})};this.create=function(b,c,d){this.doupd=d;var e=a("<label>Välj "+b.n+"&nbsp;<span>genom att klicka på bilden</span></label>").appendTo(c);this.cnt=a("<div/>").addClass("imgselection").appendTo(c);this.fieldId=b.id}},button:function(){this.createOptions=function(){var b=this;a.each(this.availOptions,function(e,c){var d=a("<div/>",{"class":"group-button sbtn",html:"<span>"+c+"</span>"}).attr("rel",c).data("val",c).click(function(){var c=a(this).hasClass("selected");b.parent.find(".group-button").removeClass("selected");if(c)b.value="";else b.value=a(this).addClass("selected").data("val");b.doupdate(true)});b.parent.append(d)})},this.getValue=function(){return this.value},this.setValue=function(a){this.parent.find(".group-button").removeClass("selected");this.parent.find('.group-button[rel="'+a+'"]').addClass("selected");this.value=a},this.beforeUpdate=function(){this.parent.find(".group-button").addClass("hidden")},this.afterUpdate=function(){},this.updateAlt=function(b){var c=this.parent;a.each(b,function(b,a){c.find('.group-button[rel="'+a+'"]').removeClass("hidden")})},this.create=function(e,b,c){this.doupdate=c;a("<label>"+e.n+"</label>").appendTo(b);var d=this.parent=a("<div/>").appendTo(b);return d}},sizebutton:function(){this.createOptions=function(){var c=this;a.each(this.availOptions.sort(b.sizeSort),function(e,b){var d=a("<div/>",{"class":"group-button sbtn",html:"<span>"+b+"</span>"}).attr("rel",b).data("val",b).click(function(){var b=a(this).hasClass("selected");c.parent.find(".group-button").removeClass("selected");if(b)c.value="";else c.value=a(this).addClass("selected").data("val");c.doupdate(true)});c.parent.append(d)})},this.getValue=function(){return this.value},this.setValue=function(a){this.parent.find(".group-button").removeClass("selected");this.parent.find('.group-button[rel="'+a+'"]').addClass("selected");this.value=a},this.beforeUpdate=function(){this.parent.find(".group-button").addClass("hidden")},this.afterUpdate=function(){},this.updateAlt=function(b){var c=this.parent;a.each(b,function(b,a){c.find('.group-button[rel="'+a+'"]').removeClass("hidden")})},this.create=function(e,b,c){this.doupdate=c;a("<label>"+e.n+"</label>").appendTo(b);var d=this.parent=a("<div/>").appendTo(b);return d}},alphabutton:function(){this.createOptions=function(){var c=this;a.each(this.availOptions.sort(b.alphaSort),function(e,b){var d=a("<div/>",{"class":"group-button sbtn",html:"<span>"+b+"</span>"}).attr("rel",b).data("val",b).click(function(){var b=a(this).hasClass("selected");c.parent.find(".group-button").removeClass("selected");if(b)c.value="";else c.value=a(this).addClass("selected").data("val");c.doupdate(true)});c.parent.append(d)})},this.getValue=function(){return this.value},this.setValue=function(a){this.parent.find(".group-button").removeClass("selected");this.parent.find('.group-button[rel="'+a+'"]').addClass("selected");this.value=a},this.beforeUpdate=function(){this.parent.find(".group-button").addClass("hidden")},this.afterUpdate=function(){},this.updateAlt=function(b){var c=this.parent;a.each(b,function(b,a){c.find('.group-button[rel="'+a+'"]').removeClass("hidden")})},this.create=function(e,b,c){this.doupdate=c;a("<label>"+e.n+"</label>").appendTo(b);var d=this.parent=a("<div/>").appendTo(b);return d}}},fixPrice:function(a){if(a==undefined)return 11111111;var b=a.replace(/[ kr]/gi,"").replace(",","."),c=parseFloat(b);return c.toString().replace(".",",")},currFormat:function(b){if(b==undefined)return 22222222;if(!shopOpt.showCents)b=Math.round(b-0);if(window.shopOpt.currFormat)return window.shopOpt.currFormat(b);var h=shopOpt.showCents?100:1;b=b.toString().replace(/\$|\,/g,"");var a=parseFloat(b),g=a==(a=Math.abs(a));a=Math.floor(a*100+.50000000001);var e=a%100,c=e.toString();a=Math.floor(a/100).toString();if(e==0)c="";else if(e<10)c="0"+c;for(var d=0;d<Math.floor((a.length-(1+d))/3);d++)a=a.substring(0,a.length-(4*d+3))+" "+a.substring(a.length-(4*d+3));var f=(g?"":"-")+a;if(shopOpt.showCents)f+=(c.length>0?".":"")+c;return f+shopOpt.lang.cur},chgNoi:function(e,c,a,d){shopcommon.ChangeNoi(e,c,function(){a&&a();!d.notrigger&&b.orderChanged()});window._gaq&&_gaq.push(["_trackEvent","CartNumberOfItemsChange","click"])},addToCartMultiple:function(j,k,c){var c=c||{},g=a.cookie("orderId");function hasAdded(d){if(!c.noupdate)if(d){if(d.OrderId&&d.OrderId>0)(!g||g==0)&&a.cookie("orderId",d.OrderId,{path:"/"});a("body").trigger("addtocart");if(d.Id<0)alert(d.Title);else{window._gaq&&_gaq.push(["Shop","AddToCart","Product",d.ArticleNr]);a(window).trigger("articleInCart",[d]);k&&k();!c.notrigger&&b.orderChanged()}}}for(var i={},h=0;h<j.length;h++){var f=j[h];if(window.shopOpt.beforeAddToCart&&!c.nopre)c=window.shopOpt.beforeAddToCart(f.artNr,f.noi,c);i[f.artNr]=f.noi}var e=c.imageFallback;if(e&&typeof e!="string")e=c.imageFallback.attr("id");var d=c.bodyFallback;if(d&&typeof d!="string")d=c.bodyFallback.attr("id");shopcommon.AddToCartMultiple(g-0,i,e||"",d||"",document.referrer,!!c.newprod,c.addAsSub,hasAdded,function(){})},addToCart:function(g,h,i,c){var c=c||{};if(window.shopOpt.beforeAddToCart&&!c.nopre)c=window.shopOpt.beforeAddToCart(g,h,c);var f=a.cookie("orderId");function hasAdded(d){if(!c.noupdate)if(d){if(d.OrderId&&d.OrderId>0)(!f||f==0)&&a.cookie("orderId",d.OrderId,{path:"/"});a("body").trigger("addtocart");if(d.Id<0)alert(d.Title);else{window._gaq&&_gaq.push(["Shop","AddToCart","Product",d.ArticleNr]);a(window).trigger("articleInCart",[d]);i&&i(d);!c.notrigger&&b.orderChanged()}}}var e=c.imageFallback;if(e&&typeof e!="string")e=c.imageFallback.attr("id");var d=c.bodyFallback;if(d&&typeof d!="string")d=c.bodyFallback.attr("id");if(shopcommon.AddToCart2&&f&&f>0)shopcommon.AddToCart2(f-0,g,h,e||"",d||"",document.referrer,!!c.newprod,hasAdded,function(){});else shopcommon.AddToCart(g,h,e||"",d||"",document.referrer,!!c.newprod,hasAdded,function(){})},removeFromCart:function(a){shopcommon.RemoveFromCart(a,b.orderChanged);window._gaq&&_gaq.push(["_trackEvent","RemoteItemFromCart","click"])},orderChanged:function(){a(b.opt.affect).length>0&&b.getOrder()},lastOrder:{},lastvat:null,getOrder:function(c){c=c||{};var d=a.cookie("orderId");if(location.hash&&location.hash.indexOf("loadcart")!=-1){var e=location.hash.substr(location.hash.indexOf("loadcart")+9)-0;if(e>0)d=e}function calcItems(b){if(!b||!b.items||!b.items.length)return 0;var c=0;a.each(b.items,function(b,a){c=c+a.Noi});return c}function gotorder(d){var e=b.lastOrder;if(e!=d){if(!e||e.country!=d.country||e.endPrice!=d.endPrice||e.adminFee!=d.adminFee||calcItems(e)!=calcItems(d)||b.lastvat!=b.showExVat()){var f=[];b.lastOrder.items&&a.each(d.items,function(){var d=this.ArticleNr,c=false;a.each(b.lastOrder.items,function(){if(this.ArticleNr==d){c=true;return true}});!c&&f.push(this)});b.lastOrder=d;var g={tag:c.tag||""};a(b.opt.affect).trigger("orderChanged",[d,f,g]);a(window).trigger("orderUpdated",[d,f,g])}b.lastvat=b.showExVat()}d.id&&d.id>0&&a.cookie("orderId",d.id,{expires:d.expires,path:"/"})}if(d>0)shopcommon.GetCart2(d,gotorder);else shopcommon.GetCart(gotorder)}},d,c={};a.fn.shopProduct=function(e){e=e||{};var k=a(this).addClass("shop-product"),A=e.id=a(this).attr("id"),m={},C,l=typeof e.imageClientId==="string"?a("#"+e.imageClientId):e.imageClientId,t=typeof e.bodyClientId==="string"?a("#"+e.bodyClientId):e.bodyClientId,v=typeof e.vatClientId==="string"?a("#"+e.vatClientId):e.vatClientId,i=typeof e.priceClientId==="string"?a("#"+e.priceClientId):e.priceClientId,r=typeof e.artnrClientId==="string"?a("#"+e.artnrClientId):e.artnrClientId,u=typeof e.specClientId==="string"?a("#"+e.specClientId):e.specClientId,s=typeof e.titleClientId==="string"?a("#"+e.titleClientId):e.titleClientId,y=true,q,z,D=[],j=[],n=[],g=[],f,w=a('<div class="shop-configcnt" />').html('<span class="loading" style="display:none">Laddar möjliga konfigurationer... vänligen vänta</span>').appendTo(k),p=a('<div class="shop-innercnt" />').hide().appendTo(w),x=e.stockCntId?a(e.stockCntId):a('<div class="stockcnt filter-cnt" />').appendTo(k),B=a("<label>"+shopOpt.lang.stockstatus+"</label>").appendTo(x),o=a('<div class="shop-stockcnt instock" />').append('<span class="hasstock">'+shopOpt.lang.hasstocktxt+'</span><span class="nostock">'+shopOpt.lang.nostocktxt+"</span>").appendTo(x),h=e.buyId&&e.buyId.length>0?a("#"+e.buyId):a("<div/>").toggle(shopOpt.showButtonDirect).appendTo(k);k.data("options",e);h.addToCart({imageFallback:e.imageClientId,bodyFallback:e.bodyClientId,noiControl:e.noiControlId,multiProductSelector:e.multiProductSelector,addAsSub:e.addAsSub}).data("shopoptions",e);a("body").data("shopoptions",e);function triggerHandlers(){if(!window.shopStarted){window.shopStarted=true;a(window).trigger("shophandlers",[b.handlers])}}k.bind("selectprod",function(b,a){m=a;toHash(a.CustomProperties)});function getPriceRange(e){var d=999999999,c=0;a.each(e,function(){var a=b.showExVat()?this.ep:this.p;if(a<d)d=a;if(a>c)c=a});if(e.length>1)return{max:c,min:d}}function enumProds(s){var r=[],k=hashObj();a.each(g,function(c,b){var a=b.handler.getValue();if(a&&a.length>0)k[b.id]=a;else if(k[b.id])delete k[b.id];r.push(a)});!shopOpt.noHash&&s&&toHash(k);function getMatches(c){var b=[];a.each(j,function(){var e=this,d=true;a.each(r,function(b,a){if(a&&a.length>0)if(e.pv[b]!=a&&!(c!==undefined&&c==b))d=false});d&&b.push(e)});return b}f=getMatches();function getArticle(a,b){if(shopOpt.useArticleCache&&c[a])b(c[a]);else{d&&clearTimeout(d);d=setTimeout(function(){shopcommon.GetArticle(a,function(d){c[a]=d;b(d)})},10)}}var u=9999999999,t=0;if(f&&f.length==1)if(q!=f[0].artnr){q=f[0].artnr;getArticle(q,function(a){m=a;openProduct(m)})}if(f&&f.length>1){z=f[0].artnr;n&&n.length>0&&!y&&getArticle(f[0].artnr,function(c){var g=f;g[0]=c;openProduct(c);a(window).trigger("productupdate",[g,openProduct]);c.ImageUrl&&c.ImageUrl.length>3&&l.attr("data-src")&&l.attr("src",l.attr("data-src").addReplaceQP("imgurl",c.ImageUrl)).fadeIn();if(!shopOpt.autoSelectFirst){var d=getPriceRange(f);if(d&&shopOpt.showButtonDirect)if(d.min==d.max){var e=b.currFormat(d.min);a(".shop-price").html(e).fadeIn();i&&i.html(e).fadeIn();h.trigger("newprice",[e])}else{var e=b.currFormat(d.min)+" - "+b.currFormat(d.max);a(".shop-price").html(e).fadeIn();i&&i.html(e).fadeIn();h.trigger("newprice",[e])}}(shopOpt.usePayair||window.Payair_DATA)&&a.updatePayAir(c,"page_"+c.PageId)})}else if(!f||f.length==0){h.trigger("prodChange",["",{InStock:0,artnr:""}]);h.trigger("newprice",[shopOpt.lang.pricestock]);o.toggleClass("instock",false);a(window).trigger("instock",[o,false])}a.each(g,function(a){g[a].handler.beforeUpdate()});y=false;var p={};f&&a.each(n,function(c){var b={};a.each(getMatches(c),function(){a.each(this.pv,function(c,d){if(!b[c])b[c]=[d];else a.inArray(d,b[c])==-1&&b[c].push(d)})});p[c]=b});a.each(g,function(a){g[a].handler.updateAlt(p[a][a]||[])});a.each(g,function(a){g[a].handler.afterUpdate()});e.autoselectsingle&&a.each(g,function(a){avalAlternative[a].length==1&&g[a].handler.setValue(avalAlternative[a][0])})}function openProduct(c){k.data("selectProd",c);if(!shopOpt.setOwnImage)c.ImageUrl&&c.ImageUrl.length>3&&l.attr("data-src")&&l.attr("src",l.attr("data-src").addReplaceQP("imgurl",c.ImageUrl)).fadeIn();else shopOpt.setOwnImage(c,f);a(window).trigger("instock",[o,c.InStock>0,c]);o.toggleClass("instock",c.InStock>0);if(c.InStock==0)h.trigger("newprice",[shopOpt.lang.pricestock]);else h.trigger("newprice",[b.showExVat()?c.PriceStringExVat:c.PriceString]);a(".shopconnect").trigger("articleupdate",[c,f]);if(!f||f.length==1||shopOpt.autoSelectFirst||e.autoSelectFirst){if(c.ProductType!="107"){h.fadeIn();i&&i.length&&i.html(b.showExVat()?c.PriceStringExVat:c.PriceString).fadeIn()}c.Spec&&c.Spec.length>0&&u&&u.length&&u.html(c.Spec).fadeIn();v&&v.length&&v.html(c.Vat).fadeIn();r&&r.length&&r.text(c.ArticleNr);c.Title&&c.Title.length&&s&&s.length&&s.html(c.Title).fadeIn();c.Description&&c.Description.length>3&&t&&t.length&&t.html(c.Description).fadeIn();a(".shop-price").html(b.showExVat()?c.PriceStringExVat:c.PriceString).fadeIn();a(".shopconnect").trigger("prodChange",[c.ArticleNr,c]);h.trigger("prodChange",[c.ArticleNr,c])}if(window.wdGlobal)wd.beforesave=function(d){var h=false,k=d[2].split("."),g=k[0],i=k[1];if(g==e.priceClientId&&c.UseDiscount)return d;function setOrg(){wd.setProp(e.imageClientId+"."+i,d[3],{nobefore:1});h=true}if(g==e.imageClientId&&i=="ImageUrl"){setOrg();if(c.BaseProperty&&c.BaseProperty.length>0){d[2]=c.BaseProperty+".ImageUrl";h=true}}var j=[];f&&a.each(f,function(){j.push(this.ArticleNr||this.artnr)});if(!shopOpt.setOwnImage)g==e.imageClientId&&i=="ImageUrl"&&shopadmin.setImages(d[3],j,function(){shopadmin.ClearArticle(wdGlobal.PageId,loadArticleData)});if(i=="Text")if(c.BaseProperty&&c.BaseProperty.length>0){var l={Vat:e.vatClientId,Price:e.priceClientId,Title:e.titleClientId};if(g==e.bodyClientId+".Text"){d[2]=c.BaseProperty+".Text";h=true}else a.each(l,function(a,f){if(f==g){d[2]=c.BaseProperty+"."+a;h=true}if(g==e.priceClientId)d[3]=b.fixPrice(d[3])})}h&&setTimeout(function(){shopadmin.ClearArticle(wdGlobal.PageId,loadArticleData)},300);return d}}function loadArticleData(){var d=setTimeout(function(){w.find(".loading").slideDown("fast")},250);if(!e.presel&&window.shopSelection)e.presel=window.shopSelection;c={};shopcommon.GetCnf(e.pageId,function(l){clearTimeout(d);p.empty();w.find(".loading").slideUp(100,function(){p.slideDown(300)});var o=l.p,k=l.i;n=o;g=[];triggerHandlers();a.each(o,function(){var e=a("<div/>").addClass("filter-cnt").appendTo(p),c=this,d=c.handler=new b.handlers[this.t||"button"];d.create(this,e,enumProds);d.availOptions=[];g.push(c)});j=[];a.each(k.items,function(){if(!shopOpt.hideNotInStock||this.st>0){var b=this,c=[];a.each(this.pv,function(a,b){c.push(k.val[a][b])});b.pv=c;j.push(b)}});j.length>1&&(shopOpt.usePayair||window.Payair_DATA)&&shopcommon.GetArticle(k.items[0].artnr,function(b){a.updatePayAir(b,"page_"+b.PageId)});a("body").trigger("productupdate",[j,openProduct]);if(k.items.length==1){shopcommon.GetArticle(k.items[0].artnr,function(a){m=a;openProduct(m)});shopOpt.hideIfSingle&&p.hide()}if(true){var c=getPriceRange(j);if(c&&shopOpt.showButtonDirect)if(c.min==c.max){var f=b.currFormat(c.min);a(".shop-price").html(f).fadeIn();i&&i.html(f).fadeIn();h.trigger("newprice",[f])}else{var f=b.currFormat(c.min)+" - "+b.currFormat(c.max);a(".shop-price").html(f).fadeIn();i&&i.html(f).fadeIn();h.trigger("newprice",[f])}a.each(j,function(){a.each(this.pv,function(b,c){if(g[b])a.inArray(c,g[b].handler.availOptions)==-1&&g[b].handler.availOptions.push(c)})});a.each(g,function(a){g[a].handler.createOptions()});function setfromHash(){var c=hashObj();if(e.presel||c){var b={};a.extend(b,e.presel,c);a.each(g,function(c,a){b[a.id]&&g[c].handler.setValue(b[a.id])});enumProds()}}setfromHash();a(window).bind("hashchange",setfromHash)}})}k.bind("refresh",loadArticleData);if(window.shopOpt.shopAddons)ql.load(window.shopOpt.shopAddons,loadArticleData);else loadArticleData()};a.fn.shopAffect=function(b){return a(this).addClass("wd-shop-affect").bind("orderChanged",b)};a.fn.noiTicker=function(c){var g=a(this),h=g.text().replace(shopOpt.lang.noitext,""),f=a("<a/>").addClass("sub").append("<span>-</span>"),e=a("<a/>").addClass("add").append("<span>+</span>"),d=a("<span/>",{text:h+shopOpt.lang.noitext});f.click(function(){c.Noi>1&&b.chgNoi(c.Id,-1,function(){d.text(c.Noi+shopOpt.lang.noitext)},{nopre:1})});e.click(function(){c.Noi<100&&b.chgNoi(c.Id,1,function(){d.text(c.Noi+shopOpt.lang.noitext)},{nopre:1})});return g.addClass("noi-ticker").empty().append(f).append(d).append(e)};a.fn.cartProduct=function(c,k){c.ParentId>0&&a(this).addClass("shop-parent");var e=a(this).empty().data("prod-data",c),j=a("<div/>").addClass("img-col").appendTo(e),d=a("<div/>").addClass("info-col").appendTo(e),g=a("<div/>").addClass("prod-toolbox").appendTo(d);a("<img/>",{src:"/gen.img?imgurl="+c.ImageUrl+"&mw="+k.imgw+"&mh="+k.imgh+"&sf=1&bc=255,255,255","class":"cart-img"}).appendTo(j);var h=a("<span/>",{"class":"cart-price",text:b.currFormat(b.showExVat()?c.PriceExcludingVat:c.Price)}).appendTo(d);if(c.OrgPrice>c.Price){a("<em/>",{"class":"cart-orgprice",text:b.currFormat(b.showExVat()?c.PriceExcludingVat:c.OrgPrice)}).appendTo(h);h.addClass("cart-saleprice")}var m=a("<a/>",{href:"/__"+c.PageId,"class":"cart-title",html:c.Title}).appendTo(d),f=a("<span/>",{"class":"cart-title",html:c.Title}).appendTo(d);a("<span/>",{"class":"cart-artnr",text:"("+c.ArticleNr+")"}).appendTo(d);var i=a("<div/>",{"class":"cart-noi",text:c.Noi+shopOpt.lang.noitext}).appendTo(g),n=a("<div/>",{"class":"cart-delete"}).data("id",c.Id).append("<span>"+shopOpt.lang.remove+"</span>").click(function(){b.removeFromCart(a(this).data("id"))}).appendTo(g),o=a("<div/>",{"class":"cart-descr",html:!c.Spec||c.Spec==c.Title?"":c.Spec}).appendTo(d);if(c.ProductType==0){f.remove();i.noiTicker(c)}else if(c.ProductType==107||c.ProductType==108){f.remove();var l=a('<i class="expire"></i>').appendTo(d);function updatetime(){if(c.Expires>new Date)l.text("Reserverad i "+Math.ceil((c.Expires-new Date)/6e4)+"min");else l.hide()}updatetime();var p=setInterval(updatetime,6e3)}else if(c.ProductType==7812||c.ProductType==7813)f.remove();else if(c.ProductType!=99&&!shopOpt.cartKeepTools){g.remove();j.remove();m.remove()}if((c.ProductType==99||shopOpt.cartKeepTools)&&c.ProductType!=0){f.remove();i.noiTicker(c)}c.ProductType==2&&Math.round((b.showExVat()?c.PriceExVat:c.Price)-0)==0&&h.addClass("prd-discount").remove();if(c.NoiInStock-c.Noi<0&&c.ProductType==0){e.addClass("cart-notinstock");d.append('<span class="notinstocktext">'+shopOpt.lang.notinstock+"</span>")}else e.removeClass("cart-notinstock");window.shopOpt.customCartRow&&shopOpt.customCartRow(c,d,e);return e};a.fn.shopcode=function(e){var f=a(this),c=a('<div class="code-status" />').hide().click(function(){a(this).fadeOut()});a(this).after(c);e.btn&&a(this).after(a('<div class="wdshop-code-btn" />').text(shopOpt.lang.addshopcode).click(function(){applyCode(f.val())}));var d="";function applyCode(a){if(a==d)return;d=a;c.fadeOut();shopcommon.ApplyCode(a,function(a){c.fadeIn();if(a==99)c.html("Koden finns inte");else if(a==1)c.html("Du har redan använt denna kampanj");else if(a==2)c.html("Kampanjen är inte aktiv förtillfället");else if(a==0)c.html("Kampanjen är nu aktiverad");else c.html("Något gick fel vid tillägningen av kampanjen, försök igen");b.getOrder()},function(){c.fadeIn().html("Något gick fel vid tillägningen av kampanjen, försök igen")})}a(this).keypress(function(b){if(b.keyCode==13){applyCode(a(this).val());b.stopPropagation();return false}})};a.fn.cart=function(d){var f=a(this),k=window.shopOpt.cartDefault,d=a.extend({},k,d||{}),g;function gotOrder(q,i,m){function appendSum(g){g.find(".cart-sumcnt").remove();var f=a("<div/>",{"class":"cart-sumcnt cf"}).appendTo(g);!shopOpt.noTotal&&f.append(a("<div/>").addClass("cart-sum").append(a("<span/>").html(b.showExVat()?shopOpt.lang.totalsumexvat:shopOpt.lang.totalsum)).append(a("<strong/>").html(b.currFormat(b.showExVat()?i.totalPriceExVat:i.totalPrice))));if(window.shopOpt.customCartSum){var j=window.shopOpt.customCartSum(f,i);if(j)i=j}i.adminFee&&i.adminFee>0&&!window.shopOpt.hideAdminFee&&f.append(a("<div/>").addClass("cart-sum cart-admfee").append(a("<span/>").html(shopOpt.lang.adminfee)).append(a("<strong/>").html(b.currFormat(i.adminFee))));i.shipping>0&&f.append(a("<div/>").addClass("cart-sum cart-cargo").append(a("<span/>").html(b.showExVat()?shopOpt.lang.shippingexvat:shopOpt.lang.shipping)).append(a("<strong/>").html(shopOpt.customShipping||b.currFormat(b.showExVat()?i.shippingExVat:i.shipping))));i.totalDiscount>0&&!window.shopOpt.hideDiscount&&f.append(a("<div/>").addClass("cart-sum cart-rea").append(a("<span/>").html(b.showExVat()?shopOpt.lang.discountexvat:shopOpt.lang.discount)).append(a("<strong/>").html(b.currFormat(b.showExVat()?i.totalDiscountexVat:i.totalDiscount))));!b.showExVat(true)&&f.append(a("<div/>").addClass("cart-sum cart-tax").append(a("<span/>").html(b.showExVat()?shopOpt.lang.vat:shopOpt.lang.ofwhichvat)).append(a("<strong/>").html(b.currFormat(i.totalVat))));f.append(a("<div/>").addClass("cart-sum line-top").append(a("<span/>").html(b.showExVat(true)?shopOpt.lang.cartsumexvat:shopOpt.lang.cartsum)).append(a("<strong/>").html(b.currFormat((b.showExVat(true)?i.endPriceExVat:i.endPrice)+(i.adminFee||0)))));(!d.overview||d.showtools)&&a("<div/>").addClass("cart-tools").append(a('<a class="cart-close"><span>'+shopOpt.lang.close+"</span></a>").click(function(){g.slideUp(300)})).append('<a class="cart-checkout sbtn" href="'+d.checkoutUrl+'">'+shopOpt.lang.gotocart+"</a>").append(a('<a class="cart-clear sbtn" href="javascript:void(0)">'+shopOpt.lang.emptycart+"</a>").click(function(){shopcommon.newCart(function(f){f>0&&a.cookie("orderId",f,{expires:14,path:"/"});h.html(d.cartEmptyText);e.fadeOut(200).empty();c.fadeOut(200).empty();b.orderChanged()})})).appendTo(f)}if(i.items&&i.items.length>0){var l=0;f.removeClass("cartempty").addClass("carthasitems");a(".shop-cart-connect").fadeIn();a.each(i.items,function(){if(this.ParentId==0)l+=this.Noi});h.html(d.itemsInCartText.format(l,b.currFormat(b.showExVat()?i.endPriceExVat:i.endPrice)));var o=c.find(".wd-cart-prod").addClass("to-remove"),j=c.find(".zoom-parent");if(j.length==0)j=a('<div class="zoom-parent" />').appendTo(c);var p;function findParent(d){var b=j;c.find(".wd-cart-prod").each(function(){if(a(this).data("cart-id")==d){b=a(this);return true}});return b}var k;function initSlider(){if(!window.shopOpt.useSlider)return;k&&clearTimeout(k);k=setTimeout(function(){j.contentslider({noi:d.noi})},200)}a.each(i.items,function(){var c=this,b=[];o.each(function(){if(a(this).data("cart-id")==c.Id){b=a(this).removeClass("to-remove");return true}});if(b.length==0)a("<div/>").addClass("wd-cart-prod cf").cartProduct(this,d).data("cart-id",this.Id).appendTo(findParent(this.ParentId));else a(b).cartProduct(this,d)});var n=c.find(".to-remove");if(n.length>0)n.slideUp(350,function(){a(this).remove();if(c.is(":empty"))c.slideUp(300);else initSlider()});else initSlider();d.overview&&c.fadeIn(200);appendSum(c)}else{f.addClass("cartempty").removeClass("carthasitems");a(".shop-cart-connect").fadeOut();h.html(d.cartEmptyText);e.fadeOut(200).empty();c.fadeOut(200).empty()}if(!d.overview){e.click(function(a){a.stopPropagation()});c.click(function(a){a.stopPropagation()});!shopOpt.dontCloseCartOnClick&&a("body").click(function(){e.slideUp(300);c.slideUp(200)});if(m.length>0&&!c.is(":visible")){e.empty().append(a("<div/>").addClass("wd-cart-intro").html(shopOpt.lang.cartintro));a.each(m,function(){e.append(a("<div/>").addClass("wd-cart-prod cf").hide().cartProduct(this,d).slideDown(300))});e.slideDown(300);g&&clearTimeout(g);g=setTimeout(function(){e.slideUp(300,function(){e.empty()})},d.newitemdelay);appendSum(e)}}}var i=a("<div/>",{"class":"cart-info"}).appendTo(f),h=a("<span/>").appendTo(i);i.bind(d.openevent,function(a){if(c.is(":visible"))if(ql.w<768)c.hide();else c.slideUp(300);else if(ql.w<768)c.show();else c.slideDown(300,function(){if(!window.shopOpt.useSlider)return;c.find(".zoom-parent").contentslider({noi:d.noi})});a.stopPropagation()}).shopAffect(gotOrder);var j=d.overview?"cart-overview":"cart-contents",c=a("<div/>",{"class":j+" cart-allprods cf"}).hide().appendTo(f);c.append(a("<div/>").addClass("wd-cart-intro").html(shopOpt.lang.incarttxt));var e=a("<div/>",{"class":j+" cart-newprods cf"}).hide().appendTo(f);e.mouseenter(function(){clearTimeout(g)});e.append('<div class="exDivIcon" />');c.append('<div class="exDivIcon" />');if(d.overview){c.show();i.hide()}b.getOrder()};a.updatePayAir=function(b,d){var c=a("#Payair_QR");if(shopOpt.payairOnlySingle)if(b&&(!d||b.ArticleNr==d)){a(".payaircnt").show();a("#Payair_button").show()}else{a(".payaircnt").hide();a("#Payair_button").hide()}var f=c.data("url")||"https://test.payair.com/embed/js/mobileshopper_product_dev.js";if(c&&c.length)if(window.Payair_DATA){if(b.Title=="")b.Title="Unnamed";Payair_DATA.setArticleID(d||b.ArticleNr);var e=b.JsonPrice;if(b.SalePrice<e&&b.SalePrice>0)e=b.SalePrice;Payair_DATA.setProductPrice(Math.round(e));Payair_DATA.setProductName(escape(b.Title))}else{c.attr("src",f+"?merchantreference="+c.attr("data-merchant")+"&articleID="+(d||b.ArticleNr)+"&product_name="+escape(b.Title)+"&product_price="+b.Price+"&product_currency=SEK");ql.load(c.attr("src"),function(){})}};a.fn.zoneSelector=function(g,f){b.currentZone=g;function fixParentSelector(){var a=c.find("li.selected"),b=a.parent().parent();if(b.hasClass("flag-misc"))b.addClass("selected").find(">span").text(e+" - "+a.find(">span").text());else c.find("li.flag-misc>span").text(e)}var c=a(this),e=a(this).find("li.flag-misc>span").text();fixParentSelector();var d=function(d,c){shopcommon.updateZone(d,function(){a(".buy-cnt").trigger("update");b.getOrder();a(window).trigger("zonechange",[b.currentZone]);c&&c();f&&a("form").submit()})};c.find("select").change(function(){b.currentZone=a(this).find(":selected").data("zone");var c=a(this).find(":selected").data("name");d(c)});c.find("li").not(".flag-misc").click(function(){c.find("li").removeClass("selected");a(this).addClass("selected");b.currentZone=a(this).data("zone");fixParentSelector();var e=a(this).data("name");window._gaq&&_gaq.push(["_trackEvent","ChangeZone","click"]);d(e,function(){c.find(">span").text(e).attr("class","shop-lang-title flag-"+b.currentZone)})});a(document).bind("orderChanged",function(g,e){var f=c.find("li.selected, select option:selected").text();if(f!=e.country){c.find("select option").removeAttr("selected");c.find("select option").filter(function(){return a(this).text()==e.country}).attr("selected","selected");c.find("li").removeClass("selected");var d=c.find("li").filter(function(){return a(this).text()==e.country});d.addClass("selected");b.currentZone=d&&d.length>0?d.data("zone"):c.find("select option:selected").data("zone");c.find(">span").text(name).attr("class","shop-lang-title flag-"+(d&&d.length>0?d.data("code"):c.find("select option:selected").data("code")))}})};a.fn.addToCart=function(c){var g,j,f=a(this),q={text:window.shopOpt.lang.buyBtn},c=a.extend(q,c||{}),n=false,p=false,l,h;function getNoi(){return l.length>0?l.val():1}function updateExternal(b){a.updatePayAir(b)}if(c.articleNr||c.firstNr){g=c.articleNr;var k=a(".shop-customprice");shopcommon.GetArticle(c.articleNr||c.firstNr,function(a){updateExternal(a);j=a;if(k&&k.length>0)k.html(b.showExVat()?a.PriceStringExVat:a.PriceString);else h.html(b.showExVat()?a.PriceStringExVat:a.PriceString);f.trigger("pricechanged",[b.showExVat()?a.PriceStringExVat:a.PriceString])})}f.data("artnr",g);function findArticleInOrder(c){var b;c.items&&a.each(c.items,function(){if(this.ArticleNr==g){b=this;return true}});return b}function setChangeProperties(g){var a=findArticleInOrder(g);if(a){f.trigger("alertAdd",[n,a]);var c=shopOpt.lang.noiincart.format(a.Noi);d.attr("title",c);i.html(c);f.addClass("wd-incart");var e=d.offset();e.top-=d.height();var a=findArticleInOrder(b.lastOrder);if(a)if(a.NoiInStock-a.Noi<1){d.fadeTo(200,.5).attr("title",shopOpt.lang.stockcart);f.addClass("notconfigged notinstock");return}i.fadeIn().css(e);setTimeout(function(){i.fadeOut()},1500);n=true;p=true}else{var c=shopOpt.lang.addincart;d.attr("title",c);i.html(c);i.fadeOut();f.removeClass("wd-incart")}}var i=a("<div/>").addClass("buy-infobox").hide().appendTo(a("body"));f.wrap('<div class="buy-outercnt" />');var o=f;if(!c.noiControl||a(c.noiControl).length==0)l=a('<input type="text" />').attr("title","Köp").addClass("buy-noi").val("1").appendTo(o);else l=a(c.noiControl);o.addClass("buy-cnt").append(h=a("<div/>").addClass("buy-price"));var k=a(".shop-customprice");if(k&&k.length)h=k;if(c.priceobj)h=c.priceobj;var d=a("<div />").css("opacity",(!g||g.length==0)&&!c.pageId?shopOpt.notInStockOpacity:"1").text(c.text).addClass("wd-buy-button sbtn").shopAffect(function(b,a){setChangeProperties(a)});if(c.pageId>0&&!c.articleNr)if(c.noiarticles&&c.noiarticles>1){d.text("Välj och köp");d.data("pageid",c.pageId).quickBuy()}f.append(d);function updateButtonNoi(){if(shopOpt.showNoiOnButton){var a=findArticleInOrder(b.lastOrder);if(a)d.text(a.Noi+shopOpt.lang.noiincartbtn);else d.text(shopOpt.lang.buyBtn)}}function getArt(d,e){var b=d.data("noi")||e;b=b-1;if(!b||!a.isNumeric(b))b=0;var c=d.data("price");if(!c||!a.isNumeric(c))c=0;return{artNr:d.data("artnr"),noi:!b||b<1?e:b,price:c?c:0}}function getMultiProducts(){if(!c.multiProductSelector)return undefined;var b=[],d=getNoi();b.push({artNr:g,noi:d,price:0});a(c.multiProductSelector).each(function(){b.push(getArt(a(this),d))});return b}var m=function(){if(g&&g.length){if(c.multiProductSelector){var a=getMultiProducts();if(a&&a.length>1){for(var d=[],b=0;b<a.length;b++)d.push(a[b].artNr);shopcommon.CalcMultiPrice(d,function(a){h.html(a);f.trigger("pricechanged",[a])});return}}shopcommon.GetArticle(g,function(a){j=a;updateData(j)})}};a(window).bind("updateprices",m);f.bind("updateprices",m);if(!c.pageId||c.articleNr){d.shopAffect(updateButtonNoi);d.bind(e,function(j){var f=a(this).parent().hasClass("notinstock")&&!shopOpt.buyNotInStock;if(a(this).hasClass("notavailable"))return false;if(g&&g.length>0&&!f&&!a(this).parent().hasClass("notinzone"))if(d.hasClass("addingtocart"))alert(shopOpt.lang.addingtocart);else{d.attr("disabled","disabled").addClass("addingtocart").text(shopOpt.lang.btnloading);function doAdd(a){b.addToCart(g,getNoi(),function(b){d.removeAttr("disabled").removeClass("addingtocart").text(shopOpt.lang.buyBtn);updateButtonNoi();a&&a(b)},c)}if(c.multiProductSelector){var e=getMultiProducts();if(e&&e.length<2)doAdd();else b.addToCartMultiple(e,function(){d.removeAttr("disabled").removeClass("addingtocart").text(shopOpt.lang.buyBtn);updateButtonNoi()},c)}else doAdd()}else{if(f)d.attr("title",shopOpt.lang.stockcart2);else if(a(this).parent().hasClass("notinzone"))d.attr("title",shopOpt.lang.notinzonetxt);else d.attr("title",shopOpt.lang.cartcheck);i.html(d.attr("title"));var h=a(this).offset();h.top-=a(this).height();i.fadeIn().css(h);setTimeout(function(){i.fadeOut()},1500)}j.stopPropagation()})}f.bind("newprice",function(b,a){h.html(a);f.trigger("pricechanged",[a])});function updateData(a){j=a;updateExternal(a);f.data("artnr",g);var c=findArticleInOrder(b.lastOrder);if(c&&a){if(c.NoiInStock-c.Noi<1){d.fadeTo(200,.5).attr("title",shopOpt.lang.stockcart);f.addClass("notconfigged notinstock");return}}else f.removeClass("notinstock");f.removeClass("notinzone").removeClass("notavailable");updateButtonNoi();h.html(b.showExVat()?a.PriceStringExVat:a.PriceString);f.trigger("pricechanged",[b.showExVat()?a.PriceStringExVat:a.PriceString]);if(a&&a.AvailableInZones)if(b.currentZone&&a.AvailableInZones&&a.AvailableInZones.length>0)if(a.AvailableInZones.indexOf(b.currentZone)==-1){f.addClass("notconfigged notinzone");h.html(shopOpt.lang.notinzone)}if(shopOpt.disableZeroPrice&&a&&a.JsonPrice<=0){f.addClass("notconfigged notavailable");d.fadeTo(200,.5).attr("title",shopOpt.lang.notavailable);h.html(shopOpt.lang.notavailabletxt)}else if(!a||shopOpt.checkStock&&(a&&a.InStock<=0)){f.addClass("notconfigged notinstock");d.fadeTo(200,.5).attr("title",shopOpt.lang.stockcart);h.html(shopOpt.lang.pricestock)}else if(g&&g.length>0){d.fadeTo(200,1);f.removeClass("notconfigged")}else{d.fadeTo(200,.5);f.addClass("notconfigged")}setChangeProperties(b.lastOrder)}f.bind("update",function(){shopcommon.GetArticle(g,function(a){j=a;updateData(j)})});f.bind("prodChange",function(c,b,a){g=b;updateData(a)});return a(this)};b.fetchAsyncPrices()})(jQuery);jQuery(window).trigger("shoploaded",[wdShop])
if (window.fd) fd('pp_wdshp.js');